<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<link type="text/css"  rel="stylesheet" href="../../css/dom.css"/>
	<script type="text/javascript" src="../../javascript/core/domUtil.js"></script>
</head>
<body >
	<div id="title" class="titleDiv">
		10.2、解密请求数据的套路
	</div>
	<div class="subTitleDiv">
		对于请求数据中，单个字段加密的情况，你可以在bpm中的第一步，使用一个自定义的action进行解密处理。
	</div>
	<div class="subTitleDiv">
		而对于请求数据整包加密（请求报文只有一长段加密内容，连字段名都没有明文显示）的情况，按照下列步骤实现：
	</div>
	<div class="tabTitleDiv">1、编写请求数据包装器类</div>
	<div class="tabTitleLine"></div>
	<div class="contentDiv">
		<label style="background-color:#ffff00;">该类必须继承javax.servlet.http.HttpServletRequestWrapper</label>，在这个类里做解析动作，将加密数据从输入流中读出来，解析成明文，再将明文设置到流中，这样就可以和正常交易一样了。
		<br/>
		<label style="background-color:#ffff00;">
			 对于“请求数据包装器类”的写法，请自行阅读com.edk4j.sdk.web.request.datawrapper.DefaultRequestDataWrapper，此处不赘述。
		</label>
	</div>
	<div class="tabTitleDiv">2、edk4j.properties的可选配置</div>
	<div class="tabTitleLine"></div>
	<div class="contentDiv">
		<div class="item addArrow">（1）在edk4j.properties配置文件中设置一个全项目默认的请求数据包装器类名</div>
		<div class="subContentDiv">
			<label style="color:#3f7f7f">#默认的请求数据包装器类名</label><br>
			application.defaultRequestDataWrapperClassName=
		</div>
		<div class="item addArrow">（2）edk4j.properties中配置所有请求的数据都被解谜</div>
		<div class="subContentDiv">
			配置项：application.wrappedAllRequestData = true/false<br>
			true，则会对所有的请求都进行解密操作 ，此时会忽略所有api里配置wrapRequestData属性<br>
			false，则会按照具体api中的属性wrapRequestData进行处理
		</div>
	</div>
	<div class="tabTitleDiv">3、配置api文件中的相关属性</div>
	<div class="tabTitleLine"></div>
	<div class="contentDiv">
		<p><span style="color:teal">&lt;</span><span style="color:#3f7f7f">Api</span></p>
		<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#7f007f">.......</span></p>
		<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#7f007f">wrapRequestData</span><span style="color:black">=</span><span style="color:#2a00ff">&quot;true或false，默认为false。当application.wrapRequestData=true时，这个属性会被忽略，所有api的请求数据都会被解密操作 &quot; </span></p>
		<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#7f007f">requestDataWrapperClass</span><span style="color:black">=</span>
			<em><span style="color:#2a00ff">&quot;</span></em>
			<em><span style="color:#2a00ff">当上面的如果设置了这个属性，则会使用这里设置的包装器类，如果没有设置这个属性，则会使用</span></em>
			<em><span style="color:#2a00ff">edk4j.properties</span></em>
			<em><span style="color:#2a00ff">中配置的</span></em>
			<span style="color:teal">application.defaultRequestDataWrapperClassName</span>
			<em><span style="color:#2a00ff">的值，如果都没有设置时，那请求数据就不能被解密处理了&quot;</span></em></p>
		<p><span style="color:teal">/&gt;</span></p>
	</div>
</body>
</html>